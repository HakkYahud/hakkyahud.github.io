#$filename = 'C:\Users\I241001\Documents\Admin\mimikatz_trunk\x64\mimikatz.exe'
$filename = "C:\Users\I241001\Documents\Admin\soeasytobypass2.exe"
$infile = Get-Item $filename
$instream = $infile.OpenRead()
$outstream = [System.IO.MemoryStream]::new()
$gzip = [System.IO.Compression.GZipStream]::new(
    $outstream,
    [System.IO.Compression.CompressionLevel]::Optimal)
$instream.CopyTo($gzip)

$gzip.Dispose()
$outstream.Dispose()
$instream.Dispose()

[Convert]::ToBase64String($outstream.ToArray()) | Out-File -FilePath "C:\Users\I241001\Documents\Admin\gzipb64.txt"